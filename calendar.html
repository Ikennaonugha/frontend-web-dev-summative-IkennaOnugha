<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Monthly Task Calendar</title>
Â  Â  <link rel="stylesheet" href="style.css">
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body>
Â  Â  Â  Â  <nav class="top-nav-container" role="navigation" aria-label="Main Campus Planner Navigation">
Â  Â  Â  Â  <a href="index.html" class="app-logo">Campus Planner</a>
Â  Â  Â  Â  <button id="theme-toggle-btn" class="theme-toggle-btn" aria-label="Toggle Light and Dark Mode">
Â  Â  Â  Â  Â  Â  â˜€ï¸/ğŸŒ™
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button id="menu-toggle-btn" class="hamburger-btn" aria-label="Toggle Navigation Menu" aria-expanded="false" aria-controls="main-nav">
Â  Â  Â  Â  Â  Â  <span class="line"></span>
Â  Â  Â  Â  Â  Â  <span class="line"></span>
Â  Â  Â  Â  Â  Â  <span class="line"></span>
Â  Â  Â  Â  </button>
Â  Â  Â  Â  
Â  Â  Â  Â  <ul id="main-nav" class="nav-menu" role="menu">
Â  Â  Â  Â  Â  Â  <li role="menuitem"><a href="index.html" class="nav-link">Dashboard</a></li>
Â  Â  Â  Â  Â  Â  <li role="menuitem"><a href="todo.html" class="nav-link">To-Do List</a></li>
Â  Â  Â  Â  Â  Â  <li role="menuitem"><a href="calendar.html" class="nav-link active">Calendar</a></li>
Â  Â  Â  Â  Â  Â  <li role="menuitem"><a href="about.html" class="nav-link active">About</a></li>
Â  Â  Â  Â  </ul>
Â  Â  </nav>

Â  Â  <div class="calendar-container">
Â  Â  Â  Â  <header style="text-align: center; margin: 2rem 0;">
Â  Â  Â  Â  Â  Â  <h1>Monthly Task Overview</h1>
Â  Â  Â  Â  Â  Â  <p style="color: var(--color-gray-dark);">See all your pending tasks visually organized by due date.</p>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="card calendar-card" role="region" aria-labelledby="current-month-display">
Â  Â  Â  Â  Â  Â  <div class="calendar-header">
Â  Â  Â  Â  Â  Â  Â  Â  <button id="prev-month" class="button" aria-label="Previous Month">&lt;</button>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 id="current-month-display" class="month-year-display">October 2025</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="next-month" class="button" aria-label="Next Month">&gt;</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="calendar-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Sun</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Mon</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Tue</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Wed</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Thu</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Fri</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-header">Sat</div>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <section class="card task-list-container" role="region" aria-labelledby="selected-day-tasks-title">
Â  Â  Â  Â  Â  Â  <h3 id="selected-day-tasks-title">Tasks for: <span id="selected-date-display">Today</span></h3>
Â  Â  Â  Â  Â  Â  <ul id="tasks-for-day" role="list">
Â  Â  Â  Â  Â  Â  Â  Â  <li style="text-align: center; color: var(--color-gray-medium); padding: 1rem 0;">Select a date on the calendar to see tasks.</li>
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  </section>
Â  Â  </div>

Â  Â  Â  Â  <script src="script.js"></script>

Â  Â  Â  Â  <script>
Â  Â  Â  Â  // NOTE: Ensure loadTasks() is called in script.js and populates window.tasks
Â  Â  Â  Â  
Â  Â  Â  Â  let today = new Date();
Â  Â  Â  Â  let currentMonth; 
Â  Â  Â  Â  let currentYear;

Â  Â  Â  Â  const monthNames = ["January", "February", "March", "April", "May", "June",
Â  Â  Â  Â  Â  Â  "July", "August", "September", "October", "November", "December"
Â  Â  Â  Â  ];
Â  Â  Â  Â  
Â  Â  Â  Â  function getTaskCountForDay(year, month, day) {
Â  Â  Â  Â  Â  Â  // Access the global tasks array
Â  Â  Â  Â  Â  Â  const globalTasks = window.tasks || [];
Â  Â  Â  Â  Â  Â  // Note: month is 0-indexed, so we use month + 1
Â  Â  Â  Â  Â  Â  const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
Â  Â  Â  Â  Â  Â  return globalTasks.filter(t => !t.isCompleted && t.dueDate === dateStr).length;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  function renderCalendar() {
Â  Â  Â  Â  Â  Â  const dateDisplay = document.getElementById('current-month-display');
Â  Â  Â  Â  Â  Â  const grid = document.querySelector('.calendar-grid');
Â  Â  Â  Â  Â  Â  const firstDay = new Date(currentYear, currentMonth, 1);
Â  Â  Â  Â  Â  Â  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
Â  Â  Â  Â  Â  Â  const startDay = firstDay.getDay(); // 0 (Sun) to 6 (Sat)
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  dateDisplay.textContent = `${monthNames[currentMonth]} ${currentYear}`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Clear previous days (keep weekday headers which are the first 7 children)
Â  Â  Â  Â  Â  Â  while (grid.children.length > 7) {
Â  Â  Â  Â  Â  Â  Â  Â  grid.removeChild(grid.lastChild);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Fill empty cells at the start (Previous Month Dates)
Â  Â  Â  Â  Â  Â  // NOTE: I've removed the calculation for prevMonthDate to keep it simple, 
Â  Â  Â  Â  Â  Â  // as showing previous month's dates is mostly for visual padding.
Â  Â  Â  Â  Â  Â  for (let i = 0; i < startDay; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const emptyCell = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  emptyCell.className = 'day-cell other-month';
Â  Â  Â  Â  Â  Â  Â  Â  // You can put a date here if you want:
Â  Â  Â  Â  Â  Â  Â  Â  // const prevMonthDate = new Date(currentYear, currentMonth, 0).getDate() - startDay + i + 1;
Â  Â  Â  Â  Â  Â  Â  Â  // emptyCell.innerHTML = `<span class="day-number">${prevMonthDate}</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(emptyCell);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Fill actual days
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const cell = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  // Correct date string generation for filtering tasks
Â  Â  Â  Â  Â  Â  Â  Â  const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  cell.className = 'day-cell';
Â  Â  Â  Â  Â  Â  Â  Â  cell.setAttribute('data-date', dateString);
Â  Â  Â  Â  Â  Â  Â  Â  cell.setAttribute('role', 'gridcell');

Â  Â  Â  Â  Â  Â  Â  Â  const taskCount = getTaskCountForDay(currentYear, currentMonth, day);

Â  Â  Â  Â  Â  Â  Â  Â  // Add today highlight (The original logic for `today` comparison was correct)
Â  Â  Â  Â  Â  Â  Â  Â  const checkDate = new Date(currentYear, currentMonth, day).setHours(0, 0, 0, 0);
Â  Â  Â  Â  Â  Â  Â  Â  if (checkDate === today.setHours(0, 0, 0, 0)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.classList.add('today');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  cell.innerHTML = `<span class="day-number">${day}</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (taskCount > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dotsContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dotsContainer.className = 'task-dots-container'; // Added class for easier CSS styling
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Replaced inline styles with a class/preferred style
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dotsContainer.style.marginTop = '0.5rem'; 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dayTasks = window.tasks.filter(t => !t.isCompleted && t.dueDate === dateString);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Filter unique tags for the dots (max 4 shown)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const displayedTags = dayTasks
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .map(t => t.tag)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .filter((value, index, self) => self.indexOf(value) === index) // Get unique tags
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .slice(0, 4);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  displayedTags.forEach(tag => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const tagDot = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Tag names must be lowercase for CSS classes
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const tagClass = tag.toLowerCase().replace(/[^a-z0-9]/g, ''); 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tagDot.className = `task-dot tag-${tagClass}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tagDot.title = tag;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dotsContainer.appendChild(tagDot);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.appendChild(dotsContainer);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  cell.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const allCells = grid.querySelectorAll('.day-cell');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  allCells.forEach(c => c.classList.remove('selected'));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.classList.add('selected');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderSelectedDayTasks(cell.getAttribute('data-date'));
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(cell);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Fill empty cells at the end
Â  Â  Â  Â  Â  Â  const totalCells = startDay + daysInMonth;
Â  Â  Â  Â  Â  Â  // We only need 42 cells total for a standard calendar (6 rows * 7 days).
Â  Â  Â  Â  Â  Â  // Calculate how many remaining cells are needed to fill the last row if totalCells > 35
Â  Â  Â  Â  Â  Â  const cellsInLastRow = totalCells % 7;
Â  Â  Â  Â  Â  Â  let endFillCount = 0;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Calculate how many cells are needed to finish the last row
Â  Â  Â  Â  Â  Â  if (cellsInLastRow !== 0) {
Â  Â  Â  Â  Â  Â  Â  Â  endFillCount = 7 - cellsInLastRow;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // To ensure a minimum of 6 rows (42 cells total) if needed for layout consistency
Â  Â  Â  Â  Â  Â  if (totalCells + endFillCount < 42 && daysInMonth > 30) {
Â  Â  Â  Â  Â  Â  Â  Â  endFillCount += 7; // Add another full row
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  

Â  Â  Â  Â  Â  Â  for (let i = 0; i < endFillCount; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const emptyCell = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  emptyCell.className = 'day-cell other-month';
Â  Â  Â  Â  Â  Â  Â  Â  // const nextMonthDate = i + 1;
Â  Â  Â  Â  Â  Â  Â  Â  // emptyCell.innerHTML = `<span class="day-number">${nextMonthDate}</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(emptyCell);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderSelectedDayTasks(date) {
Â  Â  Â  Â  Â  Â  const dateDisplay = document.getElementById('selected-date-display');
Â  Â  Â  Â  Â  Â  const listEl = document.getElementById('tasks-for-day');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Use the date string directly, it's safer for timezone issues than re-parsing a new Date()
Â  Â  Â  Â  Â  Â  const [year, month, day] = date.split('-');
Â  Â  Â  Â  Â  Â  const dateObj = new Date(year, month - 1, day); // month is 0-indexed in JS Date constructor

Â  Â  Â  Â  Â  Â  dateDisplay.textContent = dateObj.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

Â  Â  Â  Â  Â  Â  const dayTasks = (window.tasks || []).filter(t => !t.isCompleted && t.dueDate === date);

Â  Â  Â  Â  Â  Â  listEl.innerHTML = '';

Â  Â  Â  Â  Â  Â  if (dayTasks.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  listEl.innerHTML = `<li style="text-align: center; color: var(--color-gray-medium); padding: 1rem 0;">No pending tasks scheduled for this day.</li>`;
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  dayTasks.forEach(task => {
Â  Â  Â  Â  Â  Â  Â  Â  const item = document.createElement('li');
Â  Â  Â  Â  Â  Â  Â  Â  item.className = 'task-entry';
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // Determine tag color class
Â  Â  Â  Â  Â  Â  Â  Â  const tagClass = task.tag.toLowerCase().replace(/[^a-z0-9]/g, '');
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  item.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="task-entry-title">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="tag-dot tag-${tagClass}"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${task.title}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size: 0.8rem; color: var(--color-gray-medium);">${task.duration} min</span>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  listEl.appendChild(item);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  function changeMonth(delta) {
Â  Â  Â  Â  Â  Â  currentMonth += delta;
Â  Â  Â  Â  Â  Â  if (currentMonth > 11) {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = 0;
Â  Â  Â  Â  Â  Â  Â  Â  currentYear++;
Â  Â  Â  Â  Â  Â  } else if (currentMonth < 0) {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = 11;
Â  Â  Â  Â  Â  Â  Â  Â  currentYear--;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- INITIALIZATION FUNCTION ---
Â  Â  Â  Â  function initCalendar() {
Â  Â  Â  Â  Â  Â  // Find the earliest pending task to set the initial calendar view
Â  Â  Â  Â  Â  Â  const earliestTask = (window.tasks || [])
Â  Â  Â  Â  Â  Â  Â  Â  .filter(t => !t.isCompleted)
Â  Â  Â  Â  Â  Â  Â  Â  .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate))[0];
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (earliestTask) {
Â  Â  Â  Â  Â  Â  Â  Â  // Use the date string's components
Â  Â  Â  Â  Â  Â  Â  Â  const [y, m, d] = earliestTask.dueDate.split('-');
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = parseInt(m) - 1; // months are 0-indexed
Â  Â  Â  Â  Â  Â  Â  Â  currentYear = parseInt(y);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Default to current month if no tasks exist
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = today.getMonth();
Â  Â  Â  Â  Â  Â  Â  Â  currentYear = today.getFullYear();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  renderCalendar();

Â  Â  Â  Â  Â  Â  // Attach navigation listeners
Â  Â  Â  Â  Â  Â  document.getElementById('prev-month').addEventListener('click', () => changeMonth(-1));
Â  Â  Â  Â  Â  Â  document.getElementById('next-month').addEventListener('click', () => changeMonth(1));
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  // Wait for the DOM and the preceding scripts to load before initializing
Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', initCalendar);

Â  Â  </script>
</body>

</html>